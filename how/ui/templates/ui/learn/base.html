{% extends 'ui/base.html' %}{% load i18n wagtailcore_tags wagtailimages_tags %}

<!---->
{% block title %}{{ block.super }} | {% trans 'Learn' %} | {{ course.title }}{% endblock %}

<!---->
{% block navbar %}{% endblock %}

<!---->
{% block content %}
<div
  id="course-container"
  class="drawer bg-base-200 lg:drawer-open size-full overflow-hidden lg:max-h-[calc(100dvh-1rem-2px)]"
>
  <input id="course-drawer" type="checkbox" class="drawer-toggle" />

  <section
    class="drawer-content relative size-full max-w-[calc(100dvw-0.5rem)] max-h-[calc(100dvh-0.5rem)] lg:max-h-[calc(100dvh-1rem)] lg:max-w-[calc(100dvw-1rem)]"
  >
    <header
      class="rounded-b-field rounded-t-box absolute inset-x-0 top-0 z-10 px-2 backdrop-blur-3xl lg:px-4"
    >
      <nav class="navbar p-0">
        <div class="navbar-start gap-4">
          <div
            id="btn-toggle"
            class="hidden tooltip tooltip-right rtl:tooltip-left tooltip-primary"
            data-tip="{% trans 'Open drawer' %}"
          >
            <button
              onclick="toggleDrawer()"
              aria-label="close sidebar"
              class="btn btn-square btn-soft btn-sm btn-primary md:btn-md 2xl:btn-lg"
            >
              <i
                data-lucide="menu"
                class="size-4 md:size-6 xl:size-7 2xl:size-8"
              ></i>
              <span class="sr-only">{% trans 'Open drawer' %}</span>
            </button>
          </div>

          <div
            class="tooltip tooltip-right rtl:tooltip-left tooltip-primary lg:hidden"
            data-tip="{% trans 'Open drawer' %}"
          >
            <label
              for="course-drawer"
              aria-label="close sidebar"
              class="btn btn-square btn-soft btn-sm btn-primary md:btn-md 2xl:btn-lg"
            >
              <i
                data-lucide="menu"
                class="size-4 md:size-6 xl:size-7 2xl:size-8"
              ></i>
              <span class="sr-only">{% trans 'Open drawer' %}</span>
            </label>
          </div>

          <h1
            id="course-title"
            class="text-primary font-bold text-xl lg:hidden"
          >
            {% block course_title %}{{ course }}{% endblock %}
          </h1>
        </div>

        <div class="navbar-end gap-2">
          <div
            class="tooltip tooltip-left rtl:tooltip-right tooltip-primary"
            data-tip="Search"
          >
            <button
              class="btn btn-square btn-soft btn-sm btn-primary md:btn-md 2xl:btn-lg"
            >
              <i
                data-lucide="search"
                class="size-4 md:size-6 xl:size-7 2xl:size-8"
              ></i>
              <span class="sr-only">Search</span>
            </button>
          </div>

          <div
            class="tooltip tooltip-left rtl:tooltip-right tooltip-success"
            data-tip="{% trans 'Al-Wazeer' %}"
          >
            <label
              for="chat-drawer"
              class="btn btn-square btn-soft btn-sm btn-success md:btn-md 2xl:btn-lg"
            >
              <i
                data-lucide="brain-circuit"
                class="size-4 md:size-6 xl:size-7 2xl:size-8"
              ></i>
              <span class="sr-only">{% trans 'Al-Wazeer' %}</span>
            </label>
          </div>
        </div>
      </nav>
    </header>

    <div
      class="rounded-box bg-base-100 size-full overflow-y-auto max-h-[calc(100dvh-0.5rem)] lg:max-h-[calc(100dvh-1rem)]"
    >
      <main class="container grid gap-8 px-4 py-16 lg:mx-auto">
        <div class="breadcrumbs text-primary text-xs lg:text-sm">
          <ol>
            {% block breadcrumbs %}{% endblock %}
          </ol>
        </div>

        {% block course_content %}
        <figure class="skeleton aspect-video overflow-clip">
          {% image course.image scale-100 %}
        </figure>

        <div
          class="prose mx-auto prose-sm prose-video:rounded-box xl:prose-lg 2xl:prose-xl prose-headings:text-primary prose-headings:font-serif rtl:prose-headings:font-kufi prose-img:rounded-box prose-img:w-full prose-pre:bg-base-200 prose-pre:border prose-pre:border-base-300"
        >
          <h1>{% trans 'Welcome to' %} {{ course.title }}</h1>
          {{ course.description|richtext }}

          <h2>{% trans 'Prerequisites' %}</h2>
          {{ course.prerequisites|richtext }}
        </div>
        {% endblock %}
      </main>
    </div>
  </section>

  <section
    class="drawer-side md:min-w-xs lg:min-w-sm z-50 lg:z-20 lg:max-h-[calc(100dvh-1rem)]"
  >
    <label
      for="course-drawer"
      aria-label="close sidebar"
      class="drawer-overlay lg:hidden"
    ></label>

    <section
      class="rounded-box lg:bg-base-200 bg-base-100/50 flex size-full max-w-[calc(100dvw-0.5rem)] flex-col justify-between overflow-hidden overflow-y-auto backdrop-blur-3xl sm:w-10/12 md:w-8/12 lg:w-full"
    >
      <div class="flex h-full flex-col">
        <header class="flex items-center justify-between gap-4 p-4">
          <div class="flex items-center gap-2">
            <div
              class="tooltip tooltip-right rtl:tooltip-left tooltip-primary aspect-square sm:hidden"
              data-tip="{% trans 'Open drawer' %}"
            >
              <label
                for="nav-drawer"
                aria-label="{% trans 'close sidebar' %}"
                class="btn btn-square btn-soft btn-sm btn-primary md:btn-md 2xl:btn-lg"
              >
                <i
                  data-lucide="menu"
                  class="size-4 md:size-6 xl:size-7 2xl:size-8"
                ></i>
                <span class="sr-only">{% trans 'Open drawer' %}</span>
              </label>
            </div>
            {% block drawer_actions %}{% endblock %}

            <h1 class="text-primary text-xl font-bold lg:text-2xl">
              {% block drawer_title %}{{ course.title }}{% endblock %}
            </h1>
          </div>

          <div
            class="hidden tooltip tooltip-left rtl:tooltip-right hover:tooltip-error lg:block"
            data-tip="{% trans 'Close' %}"
          >
            <button
              aria-label="close sidebar"
              onclick="toggleDrawer()"
              class="btn btn-square btn-soft btn-sm btn-primary hover:btn-error md:btn-md 2xl:btn-lg"
            >
              <i
                data-lucide="x"
                class="size-4 md:size-6 xl:size-7 2xl:size-8"
              ></i>
              <span class="sr-only">{% trans 'Close' %}</span>
            </button>
          </div>

          <div
            class="tooltip tooltip-left rtl:tooltip-right hover:tooltip-error lg:hidden"
            data-tip="{% trans 'Close' %}"
          >
            <label
              for="course-drawer"
              aria-label="close sidebar"
              class="btn btn-square btn-soft btn-sm btn-primary hover:btn-error md:btn-md 2xl:btn-lg"
            >
              <i
                data-lucide="x"
                class="size-4 md:size-6 xl:size-7 2xl:size-8"
              ></i>
              <span class="sr-only">{% trans 'Close' %}</span>
            </label>
          </div>
        </header>

        <ol class="flex size-full grow flex-col gap-4 overflow-y-auto px-4">
          {% block drawer_content %}
          <li>
            <a
              href="{% url 'ui:course' course.slug %}"
              class="btn btn-sm btn-ghost btn-primary md:btn-md btn-block 2xl:btn-xl justify-start"
            >
              <i
                data-lucide="home"
                class="size-4 md:size-6 xl:size-7 2xl:size-8"
              ></i>
              <span>{% trans 'Home' %}</span>
            </a>
          </li>
          <li>
            <div class="rounded-field collapse w-full">
              <input
                id="modules"
                type="checkbox"
                name="modules"
                class="hidden"
              />

              <label
                for="modules"
                class="collapse-title btn btn-sm btn-ghost btn-primary md:btn-md btn-block 2xl:btn-xl justify-between p-4"
              >
                <span class="flex items-center gap-[inherit]">
                  <i
                    data-lucide="book-text"
                    class="size-4 md:size-6 xl:size-7 2xl:size-8"
                  ></i>
                  <span>{% trans 'Course Material' %}</span>
                </span>

                <i
                  data-lucide="chevron-down"
                  class="size-4 md:size-6 xl:size-7 2xl:size-8"
                ></i>
              </label>

              <div class="collapse-content">
                <ol class="grid gap-2">
                  {% for module in modules %}
                  <li>
                    <a
                      href="{% url 'ui:module' course.slug module.slug %}"
                      class="btn btn-sm btn-ghost btn-primary md:btn-md btn-block 2xl:btn-xl justify-between"
                    >
                      <span class="flex items-center gap-4">
                        <span class="badge badge-xs badge-success lg:badge-sm"
                          >{{ forloop.counter }}</span
                        >
                        <span>{{ module }}</span>
                      </span>

                      <i
                        data-lucide="chevron-right"
                        class="size-4 md:size-6 xl:size-7 2xl:size-8 rtl:rotate-180"
                      ></i>
                    </a>
                  </li>
                  {% endfor %}
                </ol>
              </div>
            </div>
          </li>
          <li>
            <a
              href="{% url 'ui:grades' course.slug %}"
              class="btn btn-sm btn-ghost btn-primary md:btn-md btn-block 2xl:btn-xl justify-start"
            >
              <i
                data-lucide="book-check"
                class="size-4 md:size-6 xl:size-7 2xl:size-8"
              ></i>
              <span>{% trans 'Grades' %}</span>
            </a>
          </li>
          <li>
            <a
              href="{% url 'ui:posts' course.slug %}"
              class="btn btn-sm btn-ghost btn-primary md:btn-md btn-block 2xl:btn-xl justify-start"
            >
              <i
                data-lucide="newspaper"
                class="size-4 md:size-6 xl:size-7 2xl:size-8"
              ></i>
              <span>{% trans 'Posts' %}</span>
            </a>
          </li>
          <li>
            <a
              href="{% url 'ui:new_review' course.slug course.id %}"
              class="btn btn-sm btn-ghost btn-primary md:btn-md btn-block 2xl:btn-xl justify-start"
            >
              <i
                data-lucide="stars"
                class="size-4 md:size-6 xl:size-7 2xl:size-8"
              ></i>
              <span>{% trans 'Rate this course' %}</span>
            </a>
          </li>
          {% endblock %}
        </ol>
      </div>
    </section>
  </section>
</div>

<script>
  const toggleDrawer = () => {
    document
      .getElementById("course-container")
      .classList.toggle("lg:drawer-open");
    document.getElementById("course-title").classList.toggle("lg:hidden");
    document.getElementById("btn-toggle").classList.toggle("hidden");
  };
</script>
{% endblock %}
